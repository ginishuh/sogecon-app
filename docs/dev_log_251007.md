# dev_log_251007

- Start M3 phase-2 branch (subscription auth + tests). Add phase-2 plan doc.
- API: 구독 저장/삭제 엔드포인트를 멤버 세션 가드(require_member)로 전환(임시로 admin 세션을 멤버로 간주).
- Tests: 인증 없음 401, 잘못된 구독 payload 422 추가. 전체 테스트 21개 통과.
- Web: CTA 오류 메시지 개선(권한 거부/로그인 유도).
- Tests: 관리 발송 경로(POST /notifications/admin/notifications/test) 1/min 레이트리밋 429 테스트 추가. 총 22개 통과.
 - 테스트 정리: 429 테스트에서 provider override를 try/finally로 복구, 세션/IP 설정은 httpx.AsyncClient+ASGITransport 사용.
 - Web: CTA는 ApiError.status로 401 감지(문자열 매칭 제거).

- M3-3 시작: 멤버 세션 인증 정식화(임시 admin 호환 유지).
- Member UI 보강: 헤더 역할 배지, 로그인 안내 문구 추가.
- Member UI: 멤버 전용 가드/최근 로그인 방식 저장.
- Web: UI/라우트 가드 추가(RequireAdmin/RequireMember), 관리자 전용 링크 보호.
- Web: admin notifications 페이지 RequireAdmin 가드 추가.
- M3-4 시작: 구독 암호화/정리/지표 중 암호화·지표 1차 반영.
- M3-4: prune-logs 추가, 테스트 통과(23).
- 환경/유틸: 설정 캐시 리셋 유틸 추가(reset_settings_cache), Web Push at-rest 암호화 스모크 테스트 추가.
- 마이그레이션: 0008 endpoint_hash backfill에서 MetaData.bind 제거(pyright 호환).
- 마이그레이션: 0009 endpoint_hash를 NOT NULL로 승격(백필 포함).
- 보안/안정성: decrypt_str가 키 불일치/손상 시 예외 대신 원문 반환으로 안전 실패(크래시 방지). 단위 테스트 추가.
- 의존성: pip-audit 지적(GHSA-79v4-65xg-pq4g) 대응 위해 cryptography 44.0.1로 상향.
- ABC Phase 1 착수: /auth/member/activate, /auth/member/change-password, /support/contact 추가 및 테스트(총 28개 통과). support는 개발 단계에서 파일 로그로 수신.
 - Web 스케폴드: /activate, /settings/password, /support/contact, /me, /directory 페이지 골격 추가(폼/토스트 연결). Next build OK.
