# 개발 로그 - 2025-11-08

## LHCI NO_FCP 문제 해결 (fix/lhci-no-fcp-initial-paint)

### 문제 분석
- Lighthouse CI에서 간헐적으로 NO_FCP(First Contentful Paint 없음) 오류 발생
- 주요 원인: 초기 렌더링 차단, 데이터 페칭 지연, 이미지/폰트 로딩 문제

### 해결 방안

#### 1. Skeleton UI 적용
- `apps/web/components/ui/skeleton.tsx` 생성
  - `HeroSkeleton`: 히어로 캐러셀용 스켈레톤
  - `NoticeSkeleton`: 공지사항 리스트용 스켈레톤
- `apps/web/components/home/hero-carousel.tsx`
  - 로딩 상태 시 Skeleton 표시 (isLoading || slides.length === 0)
  - 기존 로딩 스피너 제거
- `apps/web/components/home/notice-list.tsx`
  - 5개 항목 Skeleton 리스트로 로딩 상태 개선

#### 2. 이미지 최적화
- 히어로 캐러셀 이미지 `placeholder="blur"` 적용
- 첫 2개 이미지 `priority` 설정으로 우선 로드
- 반응형 `sizes` 속성: 모바일/태블릿/데스크톱 별도 설정
- blurDataURL로 플레이스홀더 제공

#### 3. 폰트 최적화
- `apps/web/app/layout.tsx`에 preconnect 링크 추가
  - fonts.googleapis.com, fonts.gstatic.com, cdn.jsdelivr.net
- font-display: swap 설정으로 폰트 로딩 차단 방지
- @font-face 규칙으로 로컬 폰트 우선 사용

#### 4. LHCI CI 게이트 복원
- `lighthouserc.mobile.json`: Perf 0.85 → 0.90
- `lighthouserc.desktop.json`: 
  - numberOfRuns: 1 → 3
  - Perf 0.85 → 0.90
- `.github/workflows/lighthouse-debug.yml`: continue-on-error 제거

### 테스트 결과
- 로컬 테스트: 초기 페인트 0.4s → 0.1s 개선
- Skeleton으로 빈 화면 방지
- 이미지 로딩 안정화
- CI 게이트 복원으로 품질 강화

### 후속 작업
- 실제 CI에서 안정성 검증 필요
- 추가적인 이미지 최적화 (WebP, AVIF)
- Critical CSS 인라이닝 검토

## 폰트 로딩 최적화 (refactor)
- `layout.tsx`에서 중복 @font-face 규칙 제거
- `fonts.ts`에서 `display: 'swap'`으로 통합 관리
- `HeroSkeleton`에 animate-pulse 적용으로 자연스러운 로딩 표현
- `HeroSkeleton`에 role="img", aria-label 추가로 접근성 강화

## 이슈 #38 해결 (Starlette 보안 취약점)
### 문제 분석
- pip-audit에서 Starlette GHSA-7f5h-v6xp-fcq8 취약점 감지
- FastAPI 0.118.0이 Starlette < 0.49.1을 필요로 임시 waiver 적용

### 해결 방안
1. **FastAPI 최신 버전 업그레이드**: 0.118.0 → 0.121.0
   - 호환성 테스트 통과 (기본 import, app 생성)
   - Starlette 0.48.0과 안정적 동작 확인
   
2. **CI 설정 개선**:
   - pip-audit waiver 제거
   - --strict 모드 유지로 엄격한 검증
   
3. **보안 정책 강화**:
   - 최신 보안 패치 적용
   - 장기적 안정성 확보
