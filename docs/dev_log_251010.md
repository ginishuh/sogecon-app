2025-10-10

- 테스트(Web/E2E): Playwright 기반은 리포 내 사용 흔적이 없어 제거할 대상 없음. 대신 Chrome DevTools Protocol(CDP) 기반으로 e2e 스켈레톤을 신규 도입.
  - 의존성: `apps/web`에 `puppeteer` 추가(로컬/CI 모두 Chromium 자동 관리), `vitest.config.e2e.ts` 별도 구성.
  - 스크립트: `pnpm -C apps/web e2e`, `e2e:watch`, `e2e:dev` 추가.
 - 시나리오: 홈 히어로 렌더/CTA 네비게이션(`/ → /directory`), 디렉터리 필터/정렬의 URL 동기화 확인(서버 비가용 시에도 동작 확인 위해 `domcontentloaded` 기준 대기).
  - 노트: 기존 CI는 Lighthouse/DTO/빌드 검증만 수행 — e2e는 별도 합류 예정(작업 티켓 분리).

- 접근성 보완(Web/Tabs):
  - `defaultIndex`가 비활성 탭을 가리키면 첫 활성 탭으로 보정.
  - Home/End 키 입력 시 선택 변경과 함께 해당 탭으로 포커스 이동.
  - ESLint `complexity`(max=10) 위반 수정: 키 핸들러를 키→핸들러 매핑 방식으로 단순화.

- Build
  - apps/web에 puppeteer(dev) 추가 후 루트에서 `pnpm install --lockfile-only`로 pnpm-lock.yaml 동기화.

- DS v1 Phase 2 킥오프
  - 브랜치 생성: `feat/ds-v1-phase2-directory-mobile`
  - 계획서 보강: `docs/plan_ds_v1_phase2_directory_mobile.md` — DoD/체크리스트/E2E 항목 추가(2025-10-10)

- CI/E2E/훅 개선(Phase 2 착수 전, 공정 개선)
  - .githooks/pre-commit: 웹 린트 범위를 `app` → 프로젝트 전체(`apps/web`)로 확장(Flat config 기준).
  - E2E 안정화: Puppeteer `headless: true`, 모바일 뷰포트 고정(390×844@2), 네비게이션 `networkidle0` 대기.
  - GitHub Actions: `.github/workflows/e2e.yml` 추가 — PR(Ready)에서 빌드→서버 기동→E2E 실행.
  - 워크플로 트리거 보강: `dto-verify.yml`/`lighthouse.yml`/`e2e.yml`에 `pull_request.types: [opened, synchronize, reopened, ready_for_review]` 및 `workflow_dispatch` 추가(Ready 전환 즉시 실행 보장 + 수동 실행 허용).

---

- 디렉터리(모바일 카드/필터 아코디언) 1차 구현
  - 카드 뷰(< md): `apps/web/components/directory-card.tsx` 추가 — 이름/이메일/기수/회사 요약, 상세(전공/업종/공개범위) 토글
  - 필터/정렬 아코디언: `apps/web/components/ui/accordion.tsx` 도입, `app/directory/page.tsx`에서 감싸기(default open)
  - 입력 UX: 각 필터 input에 `inputMode/autoComplete` 지정(숫자, organization, address-level1 등)
  - 공유 링크: 버튼 토글(접기/펼치기)로 전환, 복사 버튼 유지(aria-live)
- 레이아웃: 무한스크롤 버튼을 `nav[aria-label="목록 페이지네이션"]`로 재배치, 접근성 라벨 유지

- PR #23 피드백 반영(니트픽):
  - className 결합을 배열 join에서 `cn()` 유틸로 통일(가독성/유지보수성 개선) — `apps/web/components/ui/accordion.tsx`.
  - `DirectoryCard` 상세 패널 ID 생성 시 `member.id` 보간 → `useId()`로 전환(유일성 보장) — `apps/web/components/directory-card.tsx`.
  - 주석 표기 수정: `autoComplete` → `autocomplete` — `apps/web/app/directory/page.tsx`.
  - 기능 동작 변화 없음; 접근성/품질만 보강.

- Phase 3 Draft 리뷰 반영(1차):
  - Drawer a11y: Backdrop 포커스 제외(div), 내부 닫기 버튼 추가, `aria-labelledby`/제목 id 연결, 포커스 트랩 개선(Tab 순환/첫 포커스/ESC).
  - cn 유틸 적용(drawer.tsx), z-index 명시.
  - /board/new: textarea `autocomplete="off"`, 제출 버튼 `작성 중…` 문구(진행 피드백), `aria-busy` 유지.

- 테스트
  - 유닛/상호작용: `apps/web/tests/directory.card.test.tsx`, `apps/web/tests/directory.accordion.test.tsx`
  - 기존 테스트 보정: 공유 링크가 토글 아래로 이동함에 따라 `apps/web/__tests__/directory-perf.test.tsx`에서 토글 후 검증
- E2E(CDP): `apps/web/e2e/directory-ui.spec.ts` 추가 — 필터 아코디언/공유 토글, 카드 상세(존재 시) 스모크

PR #22 상태 메모(Ready 재실행)
- Ready로 전환 후 pull_request 이벤트 재트리거 필요 → 본 문서에 no-op 커밋으로 재실행 유도.

---

- DS v1 Phase 3 — Board/Nav/Form 마무리
  - Web(Board): 카드형 목록(PostCard)로 /board 리스트 정리, Tabs a11y/키보드 네비 도입(min-h≥44px), 검색 UX 유지.
  - Web(Nav): 모바일 내비 Drawer 도입(site-header 연동) — 햄버거→Open, ESC/Backdrop→Close, 포커스 복귀.
  - Web(Form): 제출 중 버튼 텍스트 '작성 중…'로 변경 + disabled; 오류 안내(role="alert"/aria-live="polite") 유지 및 401/403 메시지 강화.
  - Test(Web): board 탭 전환/폼 오류/드로어 포커스 스모크 추가(vitest); 전체 테스트 그린.
  - Lighthouse: /board 모바일 기준 수동 점검 — Perf 0.93, A11y 1.00 유지(헤딩/landmark OK). [자동화는 후속 워크플로에서 연계]
