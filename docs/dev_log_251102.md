# 2025-11-02

- ops: buildx/멀티아치 옵션(PLATFORMS, USE_BUILDX) 추가 — `ops/cloud-build.sh` 개선.
- ops: VPS 배포 스크립트 추가 — `scripts/deploy-vps.sh`(pull→migrate→restart→health).
- ops: Nginx 예시 설정 추가 — `ops/nginx-examples/segecon.temp.conf`.
- env: `.env.api.example`, `.env.web.example` 추가. `.dockerignore`에 `.env*` 제외 규칙 강화(템플릿은 허용).
- api: 세션 쿠키 플래그 도입 — `COOKIE_SAMESITE`/`COOKIE_SECURE`/`COOKIE_DOMAIN`(서브→별도 도메인 전환 대비).
- docs: SSOT(`docs/agents_base*.md`)·README·배포 문서에 컨테이너/VPS 플로우, GHCR, buildx, 쿠키·CORS 가이드를 반영.
- ci: GH Actions 워크플로 추가 — `build-push.yml`(main/태그 트리거로 GHCR 푸시), `deploy.yml`(수동 트리거로 SSH 배포)
- ci(security): deploy known_hosts 설정, SSH 키 파일 사용(0600); build-push 입력 tag 검증 추가
 - ci(security): pip-audit 임시 예외(GHSA-7f5h-v6xp-fcq8) — FastAPI 상향 대기, 만료 2025-12-31
- ci(security): deploy 원격 docker login에 --password-stdin 사용
- ci(semgrep): run 블록의 `${{ github.* }}` 제거, step env로 전달; SSH heredoc에 안전하게 주입
 - ci(issues): create-waiver-issue(workflow_dispatch) 추가 — Starlette GHSA-7f5h-v6xp-fcq8 트래킹 자동화
 - ops: cloud-build 멀티아치 로직 가드(복수 플랫폼은 --push 요구), buildx 중복 push 제거
- ops: cloud-start 업로드 권한 보정 시도(chown 1000:1000), deploy-vps 헬스타임아웃 변수(HEALTH_TIMEOUT)
 - ops: deploy-vps HEALTH_TIMEOUT 기본값을 함수 외부로 이동(가독성/일관성)
- infra: web.Dockerfile ARG NODE_VERSION 도입
- infra: web.Dockerfile에 corepack prepare pnpm@10.17.1 추가(빌드/런타임)
 - web: NEXT_PUBLIC_SITE_URL 빈 문자열을 기본값으로 폴백 — Next 빌드 ERR_INVALID_URL 해결
 - api: COOKIE_SAMESITE/JWT_SECRET 검증 추가(Prod 전용 강제, CI/로컬은 경고 없음); main SameSite 단순화
