# 2025-10-25 개발 로그

## 네비게이션/로그인 UX 개선 (Web)
- 헤더/드로어에서 로그인 링크 중복 제거: RequireAdmin/RequireMember 기본 안내 비표시, HeaderAuth 표시에 일관성 부여.
- /login 경로에서도 헤더 유지(상단 고정), UX 흐름 단순화.
- 모바일 드로어: 좌→우 오픈으로 변경, 상단에 ‘로그인’ 버튼 추가, 하단에 인라인 ‘빠른 로그인’ 폼 제공(로그인 성공 시 자동 닫힘).
- 데스크톱: 상단 내비(‘홈’) 왼쪽에 ‘로그인’ 링크 추가(미로그인 시만), 로그인 후에는 역할 배지+학번만 표시.
 - 헤더 4분할 의도 반영: md:grid md:grid-cols-4 적용, 로그인 링크는 우측 세션 영역으로 배치.
- 헤더 드롭다운(롤아웃) 도입: ‘총동문회 소개’와 ‘고객 지원’을 NavDropdown으로 제공(hover/focus/click 지원).
- 드롭다운 hover 이탈 지연(160ms) 적용으로 패널 사라짐 문제 완화.
 - 미로그인 시 /auth/session 호출 생략(useAuth enabled=false) — 401/CORS 로그 감소.
  - 모바일에서 NEXT_PUBLIC_WEB_API_BASE가 localhost이면 현재 호스트로 자동 대체.
  - 로그인 직후 Drawer 상태 동기화(useAuth 쿼리 함수 가드).

## 코드 변경
- apps/web/components/site-header.tsx — 드로어 방향/배치/로그인 버튼 및 인라인 로그인 폼 추가.
- apps/web/components/login-inline.tsx — 인라인 로그인 폼 신설.
- apps/web/components/header-gate.tsx — /login에서도 헤더 표시.
- apps/web/components/require-*.tsx — 기본 fallback 제거로 중복 안내 방지.
- apps/web/components/header-auth.tsx — /login 경로에서 헤더 링크 노출 방지 로직 유지.

## 검증
- 타입체크: `pnpm -C apps/web exec tsc --noEmit` OK
- 웹 유닛 테스트: 선택 실행 OK(스냅샷 영향 없음)

## 후속
- 데스크톱도 모달/인라인 로그인으로 페이지 전환 없이 처리할지 결정(요청 시 구현).

## DTO/스키마 동기화 (CI)
- 원인: 백엔드 `/auth/session` 추가 이후 `packages/schemas/openapi.json`/`index.d.ts` 미갱신으로 `dto-verify` 잡 실패.
- 조치: 로컬에서 `python scripts/export_openapi.py && pnpm -C packages/schemas run gen` 실행 후 산출물 커밋 예정.

## 리뷰 피드백 반영
- Web
  - `useAuth`: HttpOnly 쿠키는 `document.cookie`로 감지 불가 → 쿠키 탐지 제거, 항상 `/auth/session` 질의. 401은 정상 상태로 처리.
  - ESLint(JS 설정 블록): `@typescript-eslint/no-unused-vars` → `error`로 상향, `_` 접두 인자만 무시.
  - `api.ts`: 로컬호스트 정규식 비캡처 그룹으로 정리.
  - `site-header`: `flex`/`grid` 유틸 충돌 제거(브레이크포인트 전환 명확화).
- API
  - 역할 보정 중복 제거: `_ensure_member_role()` 유틸 추가하여 중복 제거.
  - `student_id` 불변성 보장: `assert` 대신 명시적 유효성 검사로 변경(Bandit B101 회피).

## 브랜드 에셋 폴더 생성
- 폰트: `apps/web/public/fonts/Brand/`
- 로고/브랜드 이미지: `apps/web/public/images/brand/`
- OG 이미지: `apps/web/public/images/og/`
- 다음 단계: 전달받은 폰트/로고 수령 후 `next/font/local` 등록 및 Tailwind `fontFamily.heading/body` 매핑 적용 예정.

## 브랜드 폰트/로고 적용
- 메뉴 폰트: 서강체(SOGANG_UNIVERSITY.otf) → Tailwind `font-menu`로 매핑, 데스크톱/모바일 내비에 적용
- 헤더 텍스트: “경제대학원 총동문회” 문구에 KoPubWorld Dotum Bold 적용(`font-kopub` + `font-bold`)
- 헤더 로고: `seogang_korean_logo.svg` 노출(텍스트 좌측)
- 파비콘: 심볼 `seogang.svg`를 `public/favicon.svg`로 배치
- 헤더 심볼 추가: 한글 로고 앞에 `seogang.svg` 배치
- 타이틀 폰트 상향: `text-sm md:text-base` → `text-base md:text-lg`

## 추가 보정(헤더 레이아웃)
- 데스크톱에서 타이틀 줄바꿈 방지 및 메뉴 우측 이동:
  - 로고/타이틀 컨테이너 `md:col-span-2`로 확장
  - 타이틀에 `whitespace-nowrap` 적용
